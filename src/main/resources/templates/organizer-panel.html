<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Панель организатора — Кадр</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <link rel="icon" type="image/png" th:href="@{/images/лого.png}">
</head>
<body>
<header th:replace="~{fragments/header :: siteHeader}"></header>

<main class="wrap">
  <div th:replace="~{fragments/alerts :: alerts}"></div>

  <div class="section-title" style="margin-top:16px">
    <h2 th:text="${'События организатора: ' + organizer.organizationName}">События организатора</h2>
    <div class="row" style="margin:0">
      <a class="btn" th:href="@{/organizer/stats}">Статистика</a>
      <a class="btn" style="margin-left:8px" th:href="@{/organizer/events/new}" data-hotkey="create-event">Добавить событие</a>
    </div>
  </div>

  <div class="card ui-table-wrap" style="margin-top:14px">
    <table class="ui-table">
      <thead>
      <tr>
        <th>ID</th>
        <th>Название</th>
        <th>Дата</th>
        <th>Билетов всего</th>
        <th>Тип</th>
        <th>Действия</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="e : ${events.content}"
          tabindex="0"
          th:attr="data-hotkey-row=${true},data-edit-url=@{|/organizer/events/${e.id}/edit|},data-delete-form=${'deleteEventForm' + e.id}">
        <td th:text="${e.id}">1</td>
        <td>
          <a class="link" th:text="${e.title}" th:href="@{|/events/${e.id}|}">Название</a>
        </td>
        <td th:text="${#temporals.format(e.eventDatetime,'dd.MM.yyyy HH:mm')}">01.01.2026 10:00</td>
        <td th:text="${e.ticketsTotal}">0</td>
        <td th:text="${e.eventType != null ? e.eventType.title : '—'}">Тип</td>
        <td class="ui-ta-right">
          <a class="btn-outline" data-hotkey="edit" th:href="@{|/organizer/events/${e.id}/edit|}">Изменить</a>
          <form th:action="@{|/organizer/events/${e.id}/delete|}" method="post" class="ui-inline" style="margin-left:6px"
                th:id="${'deleteEventForm' + e.id}" th:attr="data-hotkey=${'delete'},data-confirm=${'Удалить событие «' + e.title + '»?'}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <button class="btn-outline" type="submit">Удалить</button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>

    <div class="paging">
      <a th:if="${events.hasPrevious()}"
         th:href="@{|/organizer/panel?page=${events.number-1}&size=${events.size}&sort=${sort}|}">← Назад</a>
      <a th:if="${events.hasNext()}"
         th:href="@{|/organizer/panel?page=${events.number+1}&size=${events.size}&sort=${sort}|}">Вперёд →</a>
    </div>
  </div>
</main>

<footer><div class="wrap">© Кадр</div></footer>
</body>
</html>
